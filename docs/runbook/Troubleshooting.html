<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-runbook/Troubleshooting">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.21">
<link rel="search" type="application/opensearchdescription+xml" title="Terragraph" href="/opensearch.xml">
<link rel="stylesheet" href="/katex/katex.min.css"><title data-rh="true">Troubleshooting | Terragraph</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://terragraph.com/logo/terragraph-logo-full-RGB.png"><meta data-rh="true" name="twitter:image" content="https://terragraph.com/logo/terragraph-logo-full-RGB.png"><meta data-rh="true" property="og:url" content="https://terragraph.com/docs/runbook/Troubleshooting"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Troubleshooting | Terragraph"><meta data-rh="true" name="description" content="This document includes troubleshooting steps and addresses frequently asked"><meta data-rh="true" property="og:description" content="This document includes troubleshooting steps and addresses frequently asked"><link data-rh="true" rel="icon" href="/logo/terragraph-logo-favicon-32x32-full-RGB.png"><link data-rh="true" rel="canonical" href="https://terragraph.com/docs/runbook/Troubleshooting"><link data-rh="true" rel="alternate" href="https://terragraph.com/docs/runbook/Troubleshooting" hreflang="en"><link data-rh="true" rel="alternate" href="https://terragraph.com/docs/runbook/Troubleshooting" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://TB9T0CGM6Y-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.48218837.css">
<link rel="preload" href="/assets/js/runtime~main.0199c3c1.js" as="script">
<link rel="preload" href="/assets/js/main.c2ab4c5b.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/logo/terragraph-logo-favicon-32x32-full-RGB.svg" alt="Terragraph Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/logo/terragraph-logo-favicon-32x32-white-RGB.svg" alt="Terragraph Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/terragraph/meta-terragraph" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link githubButton navbarIconButton" title="GitHub"></a><a href="https://discord.gg/HQaxCevzus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link discordButton navbarIconButton" title="Discord"></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Docs</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/runbook">Runbook</a></li><li><a class="dropdown__link" href="/docs/developer">Developer Manual</a></li><li><a class="dropdown__link" href="/docs/whitepapers">Whitepapers</a></li></ul></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/runbook">Runbook</a><button aria-label="Toggle the collapsible sidebar category &#x27;Runbook&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/runbook/Overview">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/runbook/Quick_Start">Quick Start</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/runbook/Planning">Network Planning</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/runbook/Deployment">Deployment and Installation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/runbook/Maintenance">Maintenance and Configuration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/runbook/Monitoring">Monitoring and Alerting</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/runbook/Routing">Routing and Traffic Engineering</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/runbook/Testing">Testing and Measurements</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/runbook/Troubleshooting">Troubleshooting</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/runbook/Appendix">Appendix</a></li></ul></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_GujU"><div class="docItemContainer_Adtb"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/runbook"><span itemprop="name">Runbook</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Troubleshooting</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_aoJ5"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Troubleshooting</h1><p>This document includes troubleshooting steps and addresses frequently asked
questions related to Terragraph deployments.</p><a id="troubleshooting-basic-network"></a><h2 class="anchor anchorWithStickyNavbar_LWe7" id="basic-network-debugging">Basic Network Debugging<a class="hash-link" href="#basic-network-debugging" title="Direct link to heading">​</a></h2><p>This section describes the workflow for debugging general network issues.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="checking-controller-status">Checking controller status<a class="hash-link" href="#checking-controller-status" title="Direct link to heading">​</a></h3><p>Verify that the <code>e2e_controller</code> service is active and running without any
critical errors.</p><ul><li>For Docker Swarm installations, use the <code>docker service ls</code> and
<code>docker service logs</code> commands to show the service state and logs,
respectively.</li><li>For legacy systemd installations, use the following commands:</li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Print the systemd service status</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ systemctl status e2e_controller</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Stream the controller logs</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ journalctl -u e2e_controller -f</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If something appears wrong, verify the controller configuration (see <a href="/docs/runbook/Deployment">Deployment
and Installation</a>).</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="checking-network-status">Checking network status<a class="hash-link" href="#checking-network-status" title="Direct link to heading">​</a></h3><p>Run the following commands on the controller to find the current status of all
nodes and links in the network:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Print topology information, including node/link status</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ tg2 topology </span><span class="token function" style="color:#d73a49">ls</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Print node IPv6 addresses and software versions</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ tg2 controller status</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In a healthy network, the status of all DNs should be <code>ONLINE_INITITATOR</code>, and
all CNs should be <code>ONLINE</code>. There should be a status report for every node in
the network.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="all-nodes-are-offline">All nodes are offline<a class="hash-link" href="#all-nodes-are-offline" title="Direct link to heading">​</a></h3><p>If all nodes are offline, including PoP nodes, check the routing from the PoP
nodes to the controller.</p><ul><li>Check that the PoP node has been configured correctly (see
<a href="/docs/runbook/Deployment">Deployment and Installation</a>).</li><li>Verify that firewall rules are not blocking communication. Disabling
<code>firewalld</code> is recommended to ensure no restrictions are in place. Otherwise,
see <a href="/docs/runbook/Deployment">Deployment and Installation</a> for a list of ports used by
the cloud services.</li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ systemctl stop firewalld</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ systemctl disable firewalld</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># If NMS is installed on the same host, restart Docker as well to re-add its iptables rules</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ systemctl restart </span><span class="token function" style="color:#d73a49">docker</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="pop-nodes-are-online-and-remaining-nodeslinks-are-offline">PoP nodes are online, and remaining nodes/links are offline<a class="hash-link" href="#pop-nodes-are-online-and-remaining-nodeslinks-are-offline" title="Direct link to heading">​</a></h3><p>Check the status of a PoP node with the <code>tg2 topology ls</code> command:</p><ul><li><code>ONLINE</code> - The PoP node is unable to ignite the network due to GPS issues.<ul><li>Check the GPS lock on each PoP node using the command below. There should
be a 3D fix and ideally 16 GPS satellites locked to each Terragraph
device.</li></ul></li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ tg2 stats driver-if </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> -e </span><span class="token string" style="color:#e3116c">&quot;tgd.gpsStat.fixType&quot;</span><span class="token plain"> -e </span><span class="token string" style="color:#e3116c">&quot;tgd.gpsStat.fixNumSat&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><code>ONLINE_INITIATOR</code> - There is likely a routing issue from all other nodes.<ul><li>Check the route on the gateway or controller towards the Terragraph
network for the Terragraph prefix.</li><li>Check that BGP is working. Use the command below to print the default
routes on the PoP node; there should be a default route towards nic2.</li></ul></li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">ip</span><span class="token plain"> -6 route</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">default via fe80::66d1:54ff:feeb:a863 dev nic2 proto zebra metric </span><span class="token number" style="color:#36acaa">1024</span><span class="token plain"> pref medium</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="a-specific-node-is-offline">A specific node is offline<a class="hash-link" href="#a-specific-node-is-offline" title="Direct link to heading">​</a></h3><p>If the controller sees a node as <code>OFFLINE</code>, but it can be reached in-band, check
the following items:</p><ul><li>Verify that the node ID (MAC address) in the topology file matches the one on
the node. This can be printed on the node using the following command:</li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ get_hw_info NODE_ID</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>Verify that the controller URL on the node is correct:</li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> /tmp/mynetworkinfo </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> e2eCtrlUrl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;e2eCtrlUrl&quot;</span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;tcp://[2001::1]:7007&quot;</span><span class="token plain">,</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>Verify that the minion is running and attempting to report to the controller:</li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">tail</span><span class="token plain"> -f /var/log/e2e_minion/current</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">I0419 </span><span class="token number" style="color:#36acaa">13</span><span class="token plain">:12:50.506603  </span><span class="token number" style="color:#36acaa">3202</span><span class="token plain"> StatusApp.cpp:744</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Reporting status to controller</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>Try to ping the controller from node. If the controller is pingable, check
if TCP port 7007 is open (as described in an earlier section).</li><li>Verify that the default route (<code>::/0</code>) in the routing table points to the
PoP node. Refer to the &quot;Routing&quot; section for additional troubleshooting steps.</li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ breeze fib list</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> ::/0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">via fe80::250:43ff:fe59:a9c5@nic2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="a-specific-link-is-offline">A specific link is offline<a class="hash-link" href="#a-specific-link-is-offline" title="Direct link to heading">​</a></h3><p>If a link is down and is not being ignited, check the following items:</p><ul><li>Verify that &quot;auto-ignition&quot; on the controller is not disabled for the link or
the entire network.</li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ tg ignition state</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">14</span><span class="token plain">:19:23 </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">INFO</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">: IgnitionState</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token assign-left variable" style="color:#36acaa">igParams</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">IgnitionParams</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token assign-left variable" style="color:#36acaa">enable</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">True,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token assign-left variable" style="color:#36acaa">linkAutoIgnite</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">))</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>If there are continuously increasing <em>ignition attempts</em> (as seen in
<code>tg2 topology ls</code>), check the failure reason or look for any error messages in
the minion or firmware logs. Refer to the
<a href="/docs/runbook/Troubleshooting#troubleshooting-fw">Firmware</a> section for additional
troubleshooting steps.</li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># See LinkDownCause in DriverMessage.thrift</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ tg2 stats driver-if </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;linkDown.cause&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="terragraph-unit-is-unresponsive-or-not-powered">Terragraph unit is unresponsive or not powered<a class="hash-link" href="#terragraph-unit-is-unresponsive-or-not-powered" title="Direct link to heading">​</a></h3><ul><li>Verify that the unit has power.<ul><li>Unscrew the power cable gland.</li><li>Verify that the power connector for the primary sector is securely
inserted.</li><li>Use a digital multimeter to verify that the Terragraph power terminal
block has the correct DC voltage and polarity.</li></ul></li><li>Power cycle the unit. Remove and reseat the power connector, or disconnect
power to the power supply, then reconnect it.</li><li>If the problem persists, replace the unit.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="fiber-is-connected-to-terragraph-but-remote-switchrouter-indicates-no-link-integrity">Fiber is connected to Terragraph, but remote switch/router indicates no link integrity<a class="hash-link" href="#fiber-is-connected-to-terragraph-but-remote-switchrouter-indicates-no-link-integrity" title="Direct link to heading">​</a></h3><ul><li>Verify that the device at the other end of the fiber is powered on and
configured correctly.</li><li>Verify that the fiber settings at both sides of the connection match, and
are set as follows:<ul><li>Fiber type: Single or Multi-mode</li><li>SFPs: Single or Multi-mode</li><li>Speed: 1Gb or 10Gb</li></ul></li><li>Verify that the fiber cable polarity is plugged in correctly at both ends.<ul><li>Near side SFP - RX/TX connects to far side SFP - TX/RX.</li></ul></li><li>Using a fiber cable tester, verify that the fiber running to the Terragraph
unit has received light power.</li><li>Plug the fiber cable into a known good SFP module.</li><li>Plug the known good SFP module into the Terragraph unit.</li><li>If the problem persists, replace the unit.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="ethernet-is-connected-to-terragraph-but-ethernet-device-indicates-no-link-integrity">Ethernet is connected to Terragraph, but Ethernet device indicates no link integrity<a class="hash-link" href="#ethernet-is-connected-to-terragraph-but-ethernet-device-indicates-no-link-integrity" title="Direct link to heading">​</a></h3><ul><li>Verify that the Ethernet device is powered on and configured correctly.</li><li>If the Ethernet device is powered by PoE, verify that it is connected to the
unit.</li><li>Test the Ethernet cable from the Terragraph unit on a known good laptop.</li><li>Remove the Ethernet cable from the Terragraph unit and use a cable tester to
verify the cable integrity.</li><li>If the problem persists, replace the unit.</li></ul><a id="troubleshooting-basic-node"></a><h2 class="anchor anchorWithStickyNavbar_LWe7" id="basic-node-debugging">Basic Node Debugging<a class="hash-link" href="#basic-node-debugging" title="Direct link to heading">​</a></h2><p>This section lists steps for triaging node-level issues, mainly useful during
development or initial hardware bring-up.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="first-steps">First Steps<a class="hash-link" href="#first-steps" title="Direct link to heading">​</a></h3><p>The commands below provide a starting point for debugging and are not meant to
be comprehensive.</p><ul><li><strong>Check the node configuration.</strong> Look for any modifications in the node
configuration file and understand why they are there.</li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ diff_node_config</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> /data/cfg/node_config.json</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><strong>Check software/firmware versions.</strong> Are there matching or compatible
versions running on all nodes?</li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ tg2 version          </span><span class="token comment" style="color:#999988;font-style:italic"># show versions for several components</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> /etc/tgversion   </span><span class="token comment" style="color:#999988;font-style:italic"># show Terragraph build version</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ get_fw_version       </span><span class="token comment" style="color:#999988;font-style:italic"># show firmware version number</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><strong>Verify hardware information.</strong> In particular, check that MAC addresses are
as expected (radio MAC addresses may depend on the node configuration field
<code>envParams.VPP_USE_EEPROM_MACS</code>).</li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> /tmp/node_info</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><strong>Look for core dumps.</strong> If anything crashed, understand why.</li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">ls</span><span class="token plain"> -al /var/volatile/cores/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">ls</span><span class="token plain"> /data/kernel_crashes/vmcore.*</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><strong>Use CLIs.</strong> Use CLI commands to check the state of important services.</li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># -- e2e_minion --</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ tg2 minion status</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ tg2 minion links</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ tg2 stats driver-if</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ tg2 stats system --dump</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ tg2 tech-support</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># -- openr --</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ breeze lm links</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ breeze kvstore adj</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ breeze fib list</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ breeze tech-support</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># -- vpp --</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ vppctl show int</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ vppctl show int addr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ vppctl show ip6 fib</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># -- exabgp --</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ exabgpcli show neighbor summary</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ exabgpcli show adj-rib </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ exabgpcli show adj-rib out</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><strong>Check service logs.</strong> Make sure important services are running properly. See
<a href="/docs/runbook/Troubleshooting#troubleshooting-logs">Logs</a> for descriptions of log files.</li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">tail</span><span class="token plain"> -F /var/log/e2e_minion/current</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">tail</span><span class="token plain"> -F /var/log/vpp/current</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">tail</span><span class="token plain"> -F /var/log/vpp/vnet.log</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><strong>Check kernel logs.</strong> Terragraph driver logs can be seen in syslog files or
<code>dmesg</code>.</li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">dmesg</span><span class="token plain"> -w</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">tail</span><span class="token plain"> -F /var/log/kern.log</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><strong>Check firmware logs.</strong> If possible, enable firmware logs using the node
configuration field <code>envParams.FW_LOGGING_ENABLED</code>. See
<a href="/docs/runbook/Troubleshooting#troubleshooting-fw">Firmware</a> for troubleshooting steps
and instructions on configuring the log verbosity.</li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">tail</span><span class="token plain"> -f /var/log/wil6210/wil6210_*_fw_*.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="manual-link-bring-up">Manual Link Bring-Up<a class="hash-link" href="#manual-link-bring-up" title="Direct link to heading">​</a></h3><p>To establish a single Terragraph link manually using only the E2E minion, follow
the short list of steps below.</p><ol><li>Generate a new node configuration file using default values.</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">mv</span><span class="token plain"> /data/cfg/node_config.json /data/cfg/node_config.json.bak</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ config_get_base /data/cfg/node_config.json</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="2"><li>Only if a GPS fix is unavailable (or there is no GPS module present), disable
the GPS sync check in firmware on the initiator node.</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ config_set -i radioParamsBase.fwParams.forceGpsDisable </span><span class="token number" style="color:#36acaa">1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="3"><li>Reboot the node.</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">reboot</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="4"><li>Wait for the E2E minion to initialize and then show the radio MAC addresses.</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ tg2 minion status</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="5"><li>Enable GPS sync.</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ tg2 minion gps_enable</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="6"><li>Set the wireless channel (e.g. channel 2).</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ tg2 minion set_params -c </span><span class="token number" style="color:#36acaa">2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="7"><li>Associate the link from the initiator node using radio MAC addresses above.</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ tg2 minion assoc -i </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">initiator_mac</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> -m </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">responder_mac</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> -n dn</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>At this point, verify that all expected components are working:</p><ul><li><code>tg2 minion links</code> shows the link established at the driver/firmware layer.</li><li><code>breeze lm links</code> shows the link established at the routing layer.</li><li><code>ping6 ff02::1%terraX</code> (find &quot;X&quot; from output above) shows &quot;DUP&quot; responses
confirming link-local connectivity.</li><li><code>vppctl show int</code> shows incrementing &quot;vpp-terraX&quot; interface counters.</li></ul><a id="troubleshooting-routing"></a><h2 class="anchor anchorWithStickyNavbar_LWe7" id="routing">Routing<a class="hash-link" href="#routing" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="triage">Triage<a class="hash-link" href="#triage" title="Direct link to heading">​</a></h3><p>Run the command below to print debug information for an engineer to examine.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ breeze tech-support</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="background">Background<a class="hash-link" href="#background" title="Direct link to heading">​</a></h3><p>Every link-state routing protocol incorporates the following steps and
components:</p><ul><li><strong>Link discovery</strong> - Learn the underlying system&#x27;s link information,
including name, status, and addresses.</li><li><strong>Neighbor discovery</strong> - Discover neighbors on the VLAN of each link.</li><li><strong>Link-state database</strong> - Record the neighbor and prefix information for each
node.</li><li><strong>Route computation</strong> - Use the global link-state database to compute a route to
each destination.</li><li><strong>Route programming</strong> - Program routes onto the underlying system.</li></ul><p>Routing can fail if a problem occurs in any of these stages. It is always
recommended to troubleshoot issues serially.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="basic-checks">Basic Checks<a class="hash-link" href="#basic-checks" title="Direct link to heading">​</a></h3><p>Verify that Open/R is running <em>and not crashing</em>. To do so, run the following
command several times and check that the process ID has not changed:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">ps</span><span class="token plain"> -A </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> openr</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If applicable, do the same for the <code>fib_vpp</code> process.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="link-discovery">Link Discovery<a class="hash-link" href="#link-discovery" title="Direct link to heading">​</a></h3><p>Use the following command to list all links known to Open/R&#x27;s <code>LinkMonitor</code>
module:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ breeze lm links</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> Node Overload: NO  </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Interface  Status  Overloaded  Metric Override  ifIndex  Addresses</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">---------  ------  ----------  ---------------  -------  ------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nic1       Up                                         </span><span class="token number" style="color:#36acaa">3</span><span class="token plain">  fe80::250:43ff:fe46:dbbb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nic2       Up                                         </span><span class="token number" style="color:#36acaa">4</span><span class="token plain">  fe80::250:c2ff:fec9:9e9a</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Any interface on the system must be seen by Open/R before neighbor discovery can
be performed. Look for the following issues:</p><ul><li>Make sure all expected links are listed with the correct status (&quot;Up&quot; or &quot;Down&quot;)
and address.</li><li>If a link status is &quot;Down&quot;, check if a lower layer is down (L2 or driver issue).</li><li>If a link is not listed, then the link is not configured on the system (driver
issue).</li><li>A node or interface should <em>not</em> be &quot;overloaded&quot; unless undergoing a drain
operation. If the &quot;overload&quot; flag is incorrectly set, run the appropriate
command to unset it:</li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ breeze lm unset-node-overload</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ breeze lm unset-link-overload </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">interface</span><span class="token operator" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>If pinging any of the link-local addresses is unsuccessful, then either a
problem exists in the underlying driver/lower layer or the other end of the
link is not ignited correctly.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="neighbor-discovery">Neighbor Discovery<a class="hash-link" href="#neighbor-discovery" title="Direct link to heading">​</a></h3><p>Use the following command to list the adjacencies that have propagated to
Open/R&#x27;s <code>KvStore</code>:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ breeze kvstore adj</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> node-01.02.03.04.05.06&#x27;s adjacencies, version: </span><span class="token number" style="color:#36acaa">3</span><span class="token plain">, Node  Label: </span><span class="token number" style="color:#36acaa">1064</span><span class="token plain">, Overloaded?: False</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Neighbor                Local Interface    Remote  Interface      Metric    Weight    Adj Label  NextHop-v4     NextHop-v6                   Uptime</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">node-00.00.00.10.0e.45  terra0              terra0                     </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">         </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">            </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">0.0</span><span class="token plain">.0.0       fe80::200:ff:fe10:e45        8d1h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">node-00.00.00.10.0e.47  nic2                nic2                       </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">         </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">            </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">0.0</span><span class="token plain">.0.0       fe80::250:c2ff:fec9:9c5d     8d1h</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If an expected neighbor is missing over a working link, then go through the
following steps:</p><ul><li>Verify that link-local multicast packets are received from the neighboring
node.</li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ tcpdump -i terra0 udp port </span><span class="token number" style="color:#36acaa">6666</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tcpdump: verbose output suppressed, use -v or -vv </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> full protocol decode</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">listening on terra0, link-type EN10MB </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Ethernet</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">, capture size </span><span class="token number" style="color:#36acaa">262144</span><span class="token plain"> bytes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">15</span><span class="token plain">:17:25.350335 IP6 fe80::200:ff:fe10:e45.6666 </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> ip6-allnodes.6666: UDP, length </span><span class="token number" style="color:#36acaa">189</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">15</span><span class="token plain">:17:26.189291 IP6 fe80::3a3a:21ff:feb0:29d.6666 </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> ip6-allnodes.6666: UDP, length  </span><span class="token number" style="color:#36acaa">189</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>If the link-local multicast packets are not received, check if the <code>MULTICAST</code>
configuration is set on the interface.</li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">ip</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">link</span><span class="token plain"> show terra0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">12</span><span class="token plain">: terra0: </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">BROADCAST,MULTICAST,UP,LOWER_UP</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> mtu </span><span class="token number" style="color:#36acaa">1500</span><span class="token plain"> qdisc mq state UP mode DEFAULT group default qlen </span><span class="token number" style="color:#36acaa">1000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    link/ether 00:00:00:10:0b:47 brd ff:ff:ff:ff:ff:ff</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>If packets are going through but no adjacencies are formed, verify that both
ends of the link are using the same domain. Open/R will not form adjacencies
between nodes with different domains. The domain is set in the Open/R
configuration file (&quot;domain&quot; field in <code>/var/run/openr_config.json</code>).</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="key-value-store-kvstore">Key-Value Store (<code>KvStore</code>)<a class="hash-link" href="#key-value-store-kvstore" title="Direct link to heading">​</a></h3><p><code>KvStore</code> provides a data bus for distributed computing, as it enables all nodes
to have the same view of the network.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="peers">Peers<a class="hash-link" href="#peers" title="Direct link to heading">​</a></h4><p>Every neighbor listed in the adjacencies database should be added as a <code>KvStore</code>
peer. Use the following command to list all peers:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ breeze kvstore peers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> node-01.02.03.04.05.06&#x27;s peers  </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> node-00.00.00.10.0e.45</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cmd via tcp://</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">fe80::200:ff:fe10:e45%terra0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">:60002</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> node-00.00.00.10.0e.47</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cmd via tcp://</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">fe80::250:c2ff:fec9:9c5d%nic2</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">:60002</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If the same neighbor appears over multiple links, it is added only once into
<code>KvStore</code>. This could happen when, for instance, two PoP sites have a wireless
link between them along with a wired link (required for PoP nodes). Open/R will
typically sync on the wired link, and the wireless link will never be used for
any traffic. A Terragraph watchdog monitors all wireless links to check if any
data is flowing, and will restart the E2E minion if no data is passed for a few
minutes. <strong>This should be prevented in Terragraph by not allowing wireless links
between PoP sites.</strong></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="consistency">Consistency<a class="hash-link" href="#consistency" title="Direct link to heading">​</a></h4><p>In steady state and under stable network conditions, all nodes should report the
same keys and hashes for each. This can be seen using the following command:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ breeze kvstore keys</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="link-state-database-lsdb">Link-State Database (<code>Lsdb</code>)<a class="hash-link" href="#link-state-database-lsdb" title="Direct link to heading">​</a></h3><p>Every node in the network contributes two major pieces of information to
<code>KvStore</code> with the following key format:</p><ul><li><code>adj:&lt;node-name&gt;</code> - The node&#x27;s adjacency information.</li><li><code>prefix:&lt;node-name&gt;</code> - The network prefix owned/proxied by the node.</li></ul><p>Use the following command to dump all keys:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ breeze kvstore keys</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> Available keys </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> KvStore  </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Key                            OriginatorId              Version  Hash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-----------------------------  ----------------------  ---------  ----------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">adj:node-00.00.00.10.0e.42     node-00.00.00.10.0e.42          </span><span class="token number" style="color:#36acaa">4</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">3845919268</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">allocprefix:188                node-00.00.00.10.0e.42          </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">3527252845</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">prefix:node-00.00.00.10.0e.42  node-00.00.00.10.0e.42          </span><span class="token number" style="color:#36acaa">9</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">520548462</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Verify that the <code>prefix</code> and <code>adj</code> keys are present for all nodes. Otherwise,
follow these steps to troubleshoot:</p><ul><li>If prefixes are missing, check that the Open/R prefix allocator is enabled
(i.e. either <code>OPENR_ALLOC_PREFIX</code> or <code>OPENR_STATIC_PREFIX_ALLOC</code> is set in the
configuration file). The following command lists the prefixes advertised by
all nodes:</li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ breeze kvstore prefixes --nodes all</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="route-computation">Route Computation<a class="hash-link" href="#route-computation" title="Direct link to heading">​</a></h3><p>Open/R&#x27;s <code>Decision</code> module consumes the global link-state database from
<code>KvStore</code> and, on each node, computes the best path to all other prefixes and
generates routing information. Along with the best paths, Loop-Free Alternates
(LFAs) are also programmed.</p><p>Use the following command to request the routing table from <code>Decision</code> module:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ breeze decision routes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> Routes </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> node-00.00.00.10.0b.47  </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2001</span><span class="token plain">:a:b:c::/64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">via fe80::200:ff:fe10:b4c@terra0 metric </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> ::/0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">via fe80::250:43ff:fe59:a9c5@nic2 metric </span><span class="token number" style="color:#36acaa">4</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">via fe80::250:43ff:fef2:130a@nic2 metric </span><span class="token number" style="color:#36acaa">5</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>When troubleshooting routes to a particular prefix, verify that a route has been
computed and that the metric values are correct for the best next-hops (lower is
more preferable).</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="route-programming">Route Programming<a class="hash-link" href="#route-programming" title="Direct link to heading">​</a></h3><p>Routes computed by the <code>Decision</code> module are then programmed by the <code>Fib</code> agent
(ex. <code>fib_vpp</code>) via Thrift APIs.</p><p>Use the following command to print all routes on the <code>Fib</code> agent:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ breeze fib list</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> node-00.00.00.10.0b.47&#x27;s FIB routes by client </span><span class="token number" style="color:#36acaa">786</span><span class="token plain">  </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2001</span><span class="token plain">:a:b:c::/64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">via fe80::200:ff:fe10:b4c@terra0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> ::/0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">via fe80::250:43ff:fe59:a9c5@nic2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>When troubleshooting routes to a particular prefix, verify that the intended
next-hop is programmed. Otherwise, follow these steps to troubleshoot:</p><ul><li>If a route is missing but was reported by the <code>Decision</code> module, then it is
a sync error that may be resolved by restarting the <code>openr</code> service.</li><li>If applicable, check that routes are programmed correctly into the VPP FIB
by running the command below.</li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ vppctl show ip6 fib</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><a id="troubleshooting-logs"></a><h2 class="anchor anchorWithStickyNavbar_LWe7" id="logs">Logs<a class="hash-link" href="#logs" title="Direct link to heading">​</a></h2><p>This section describes important logs generated on Terragraph nodes.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="log-descriptions">Log Descriptions<a class="hash-link" href="#log-descriptions" title="Direct link to heading">​</a></h3><p>The table below provides a non-exhaustive list of log files.</p><p>Note that the logs in <code>/var</code> are archived to flash on each reboot and also
periodically, so a longer continuous log history is often available.</p><table><thead><tr><th>Log</th><th>Description</th></tr></thead><tbody><tr><td><code>/data/log/reboot_history</code></td><td>Time and reason for each reboot. These are rotated (older file is suffixed &quot;.2&quot;).</td></tr><tr><td><code>/data/format_data.log</code></td><td>Contains the timestamp when the /data partition required re-formatting and re-initialization. The reformat attempts to preserve some configuration, but not logs.</td></tr><tr><td><code>/var/log/e2e_minion/current</code></td><td>E2E minion logs.</td></tr><tr><td><code>/var/log/e2e_minion/process_history</code></td><td>E2E minion startup history, created the first time that the minion restarts.</td></tr><tr><td><code>/var/log/e2e_controller/current</code></td><td>E2E controller logs (when running the controller on a TG node).</td></tr><tr><td><code>/var/log/stats_agent/current</code></td><td>Stats agent logs.</td></tr><tr><td><code>/var/log/fluent-bit/current</code></td><td>Fluent Bit (log daemon) logs.</td></tr><tr><td><code>/var/log/openr/current</code></td><td>Open/R (routing daemon) logs.</td></tr><tr><td><code>/var/log/fib_vpp/current</code></td><td>Open/R VPP FIB agent logs.</td></tr><tr><td><code>/var/log/exabgp/current</code></td><td>ExaBGP (BGP daemon) logs.</td></tr><tr><td><code>/var/log/gpsd/current</code></td><td>gpsd (GPS daemon) logs.</td></tr><tr><td><code>/var/log/vpp/current</code></td><td>VPP startup logs.</td></tr><tr><td><code>/var/log/vpp/vnet.log</code></td><td>VPP and DPDK logs, including <code>wil6210</code> and <code>dpaa2</code> Poll Mode Driver (PMD) logs.</td></tr><tr><td><code>/var/log/vpp-debug.log</code></td><td>VPP CLI (<code>vppctl</code>) command history.</td></tr><tr><td><code>/var/log/vpp_chaperone/current</code></td><td>VPP configuration service logs.</td></tr><tr><td><code>/var/log/wil6210/</code></td><td>Directory containing firmware and microcode logs when using the node configuration field <code>envParams.FW_LOGGING_ENABLED</code>.</td></tr><tr><td><code>/var/log/kern.log</code></td><td>Kernel and TG driver logs.</td></tr><tr><td><code>/var/log/dmesg</code></td><td>Recent items in <code>kern.log</code>, also accessible via the <code>dmesg</code> command.</td></tr><tr><td>Linux crash (panic) logs</td><td>Panic logs and kernel context are saved in a dedicated flash partition. On Puma, the kernel message log is saved to <code>/data/kernel_crashes/vmcore.&lt;date&gt;</code>. Note that the node will reboot within 3 minutes of a kernel crash.</td></tr></tbody></table><p>If the software watchdog is enabled, the following logs will also be generated:</p><table><thead><tr><th>Log</th><th>Description</th></tr></thead><tbody><tr><td><code>/var/log/wdog_repair_history</code></td><td>Log of every watchdog-initiated repair since the last reboot. These are rotated (older file is suffixed &quot;.2&quot;).</td></tr><tr><td><code>/var/log/openr/openr_debug.log</code></td><td>Periodic traceroute logs collected by the watchdog when no PoP node was reachable. The log also shows the times when PoP nodes were unknown. This log is rotated, and the older version has a suffix.</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="automatically-generated-logs">Automatically-Generated Logs<a class="hash-link" href="#automatically-generated-logs" title="Direct link to heading">​</a></h3><p>Certain log files are collected continuously on the temporary filesystem in the
<code>/var/log/</code> directory. These include logs for Terragraph software as well as
system state. The files in this directory are archived and rotated to the flash
in <code>/data/log/logs.x.tar.gz</code> (with x=1 being the latest), both periodically and
before reboots. Note that some less frequently updated logs only exist on the
flash within <code>/data/log/</code> or <code>/data/</code>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="logs-generated-manually">Logs Generated Manually<a class="hash-link" href="#logs-generated-manually" title="Direct link to heading">​</a></h3><p>An extensive system dump archive can be created manually in
<code>/tmp/sysdump-&lt;date&gt;.tgz</code> using the <code>sys_dump</code> command.</p><a id="troubleshooting-fw"></a><h2 class="anchor anchorWithStickyNavbar_LWe7" id="firmware">Firmware<a class="hash-link" href="#firmware" title="Direct link to heading">​</a></h2><p>This section contains frequently asked questions relating to firmware issues.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-are-the-signs-of-firmware-crashes">What are the signs of firmware crashes?<a class="hash-link" href="#what-are-the-signs-of-firmware-crashes" title="Direct link to heading">​</a></h3><ul><li>The node has no RF links.</li><li>A radio displays unknown status:</li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ tg2 minion status</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Radio MAC           Status           GPS Sync</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">------------------  ---------------  ---------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00:00:00:10:0b:47   N/A </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">crashed?</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">   </span><span class="token boolean" style="color:#36acaa">false</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>There are firmware core dumps present.</li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">ls</span><span class="token plain"> -al /var/volatile/cores/wil6210_fw_core_*</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>The E2E minion logs indicate that a Wigig device is down:</li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">tail</span><span class="token plain"> -f /var/log/e2e_minion/current</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">I0305 00:06:12.570667  </span><span class="token number" style="color:#36acaa">3342</span><span class="token plain"> StatusApp.cpp:1196</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">00:00:00:10:0b:4</span><span class="token operator file-descriptor important" style="color:#393A34">7</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> Device status: DOWN</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-are-the-possible-causes-of-firmware-crashes">What are the possible causes of firmware crashes?<a class="hash-link" href="#what-are-the-possible-causes-of-firmware-crashes" title="Direct link to heading">​</a></h3><p>Firmware-related error messages are printed out by the wil6210 Poll Mode Driver
(PMD) in VPP logs which are found in <code>/var/log/vpp/vnet.log</code>. Causes include the
following:</p><ul><li>The initialization of the firmware failed. The VPP logs show messages such as:</li></ul><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Firmware not ready after x ms</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>A firmware assert occurred. Assert codes can be used to identify specific
firmware errors. The VPP logs show messages such as:</li></ul><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Firmware error detected, assert codes FW &lt;hex fw assert code&gt;, UCODE &lt;hex ucode assert code&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>The node is not configured as an RF node. This fundamental setting is
controlled by a variable read from EEPROM, <code>tg_if2if</code>, which must be set to 0
for RF nodes.</li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Check if configured as an IF node</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ get_hw_info TG_IF2IF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Switch between RF/IF node</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token assign-left variable" style="color:#36acaa">db_eeprom</span><span class="token operator" style="color:#393A34">=</span><span class="token variable" style="color:#36acaa">$(</span><span class="token variable" style="color:#36acaa">fdtget /sys/firmware/fdt /chosen eeprom</span><span class="token variable" style="color:#36acaa">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ fdtput -p </span><span class="token string" style="color:#e3116c">&quot;</span><span class="token string variable" style="color:#36acaa">$db_eeprom</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"> -t i /board tg-if2if </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token number" style="color:#36acaa">0</span><span class="token operator" style="color:#393A34">|</span><span class="token operator file-descriptor important" style="color:#393A34">1</span><span class="token operator" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-are-signs-that-a-node-has-rebooted-unexpectedly">What are signs that a node has rebooted unexpectedly?<a class="hash-link" href="#what-are-signs-that-a-node-has-rebooted-unexpectedly" title="Direct link to heading">​</a></h3><ul><li>Unexpected reboots are logged in the file <code>/data/log/reboot_history</code>. If the
&quot;dirty&quot; tag appears <em>by itself</em> on any line, it indicates an abnormal reboot
which was not initiated by the &quot;reboot&quot; command or the watchdog.</li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> /data/log/reboot_history</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">up </span><span class="token number" style="color:#36acaa">1523315537</span><span class="token plain"> Mon, 09 Apr </span><span class="token number" style="color:#36acaa">2018</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">16</span><span class="token plain">:12:17 -0700 dirty</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>Linux crashes will create logs in a dedicated flash partition. On Puma, the
kernel message log is saved to <code>/data/kernel_crashes/vmcore.&lt;date&gt;</code>.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="why-cant-a-wireless-link-be-established">Why can&#x27;t a wireless link be established?<a class="hash-link" href="#why-cant-a-wireless-link-be-established" title="Direct link to heading">​</a></h3><ul><li>Verify that at least one end of the link is in the <code>ONLINE_INITIATOR</code> state.
Typically, it should take less than a minute for a sector to transition from
<code>ONLINE</code> to <code>ONLINE_INITIATOR</code>. If the node remains only <code>ONLINE</code>, then it
has not acquired GPS timing and cannot initiate a wireless link. This can be
verified via the firmware stat <code>tgf.&lt;mac_addr&gt;.tsf.syncModeGps</code>, which will
be 0 (instead of 1).<ul><li>There are potential issues if the following firmware stats are increasing:<ul><li><code>tgf.&lt;mac_addr&gt;.gps.numMissedSec</code>, <code>tgf.&lt;mac_addr&gt;.gps.numPpsErr</code></li></ul></li><li>Check the following stats to see why the GPS chip may not be able to
estimate time (and position):<ul><li><code>tgd.gpsStat.fixNumSat</code> - Must be at least 1, or at least 4 if the
site location is missing from the topology.</li></ul></li><li>Check the list of all satellites visible to the GPS chip:<ul><li><code>tgd.gpsStat.&lt;id&gt;.used</code> - Whether this satellite is in use.</li><li><code>tgd.gpsStat.&lt;id&gt;.snr</code> - Usable satellites would typically have SNR
greater than 25.</li></ul></li></ul></li><li>Verify that beamforming (BF) messages (Tx/Rx) are being successfully
exchanged using the commands below. On the initiator node, the
<code>tgf.MAC.mgmtTx.bfTrainingReq</code> and <code>tgf.MAC.mgmtRx.bfTrainingRsp</code> stats
should be non-zero. On the responder node, the <code>tgf.MAC.mgmtRx.bfTrainingReq</code>
and <code>tgf.MAC.mgmtTx.bfTrainingRsp</code> stats should be non-zero. If this is not
the case, then check for misalignment between the nodes.</li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ tg2 stats driver-if </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> -e </span><span class="token string" style="color:#e3116c">&quot;bfTrainingReq&quot;</span><span class="token plain"> -e </span><span class="token string" style="color:#e3116c">&quot;bfTrainingRsp&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>The node configuration for over-the-air (OTA) encryption should match on
both ends of the link. Verify that the <code>wsecEnable</code> config field is the same
on both nodes, as well as 802.1X parameters if applicable.</li><li>Verify that the interface stats for &quot;RX packets&quot; and &quot;TX packets&quot; are
increasing, which indicates that the link is active.</li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">ifconfig</span><span class="token plain"> terra0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">terra0 Link encap:Ethernet HWaddr 02:08:02:00:01:00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">inet6 addr: fe80::8:2ff:fe00:100/64 Scope:Link</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> UP BROADCAST RUNNING MULTICAST MTU:7800 Metric:1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RX packets:7260 errors:0 dropped:0 overruns:0 frame:0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> TX packets:7264 errors:0 dropped:0 overruns:0 carrier:0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">collisions:0 txqueuelen:1000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> RX bytes:1429692 </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1.3</span><span class="token plain"> MiB</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> TX bytes:1428796 </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1.3</span><span class="token plain"> MiB</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>Initiate a ping on both nodes, either using the other end&#x27;s IPv6 address as
the destination or doing a multicast ping on the link&#x27;s interface. If this
ping succeeds, then the link is active.</li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Ping the destination IPv6 address</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ ping6 fe80::8:2ff:fe00:103%terra0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Ping the multicast address</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ ping6 ff02::1%terra0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="why-is-throughput-lower-than-expected">Why is throughput lower than expected?<a class="hash-link" href="#why-is-throughput-lower-than-expected" title="Direct link to heading">​</a></h3><ul><li>Check the firmware stats for PER (<code>tgf.&lt;mac_addr&gt;.staPkt.perE6</code>) and MCS
(<code>tgf.&lt;mac_addr&gt;.staPkt.mcs</code>). The PER should be close to 0%. The MCS should
be greater than 9 for high throughput.</li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ tg2 stats driver-if </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> -e </span><span class="token string" style="color:#e3116c">&quot;staPkt.mcs&quot;</span><span class="token plain"> -e </span><span class="token string" style="color:#e3116c">&quot;staPkt.perE6&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>Check the CPU usage on the Linux host and the firmware. The host CPU usage is
tracked via the system stat <code>cpu.util</code>. The firmware CPU usage can be viewed
via the stat <code>tgf.&lt;mac_addr&gt;.miscSys.cpuLoadAvg</code>, which captures the <em>idle</em>
CPU as a percentage; if this stat drops to 3 or less, then the firmware is
overloaded.</li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ tg2 stats driver-if </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;cpuLoadAvg&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>Make sure that firmware info logs are disabled. Running the command below
will enable only error logging:</li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ tg2 minion fw_set_log_config -l error</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>Check that firmware is not in BF responder mode, which reserves the Rx BF
slots and reduces maximum throughput by roughly 50%. If a sector is in
responder mode, the following firmware stats will indicate the Rx BF slot
count incrementing while the Tx BF slot count remains constant.</li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ tg2 stats driver-if </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> -e </span><span class="token string" style="color:#e3116c">&quot;slot.numOfRxBfSlotsPgmrd&quot;</span><span class="token plain"> -e </span><span class="token string" style="color:#e3116c">&quot;slot.numOfTxBfSlotsPgmrd&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="change-log-levels-of-firmware-modules">Change log levels of firmware modules<a class="hash-link" href="#change-log-levels-of-firmware-modules" title="Direct link to heading">​</a></h3><ul><li>Show all supported firmware modules and logging levels:</li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ tg2 minion fw_set_log_config --help</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>Change the logging level:</li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># set logging level to &#x27;info&#x27; for all fw modules</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ tg2 minion fw_set_log_config -l info</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># set logging level to &#x27;debug&#x27; for a specific node and specific fw modules</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ tg2 minion fw_set_log_config -m la_tpc -m framer -m tpc -l debug</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><a id="troubleshooting-watchdog"></a><h2 class="anchor anchorWithStickyNavbar_LWe7" id="watchdog">Watchdog<a class="hash-link" href="#watchdog" title="Direct link to heading">​</a></h2><p>The Terragraph watchdog is a collection of monitors that observes different
aspects of a node&#x27;s health. These monitors perform various repair actions,
including reboots when necessary.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="watchdog-logs">Watchdog Logs<a class="hash-link" href="#watchdog-logs" title="Direct link to heading">​</a></h3><p>All watchdog actions are timestamped and logged to the following locations:</p><ul><li><code>/var/log/wdog_repair_history</code> - Log of every watchdog-initiated repair
since the last reboot.</li><li><code>/data/log/reboot_history</code> - Reason for each reboot, including reboots that
were not initiated by the watchdog.</li></ul><p>Both of the above logs are rotated, and the older rotations are renamed with a
numeric suffix. Copies of <code>wdog_repair_history</code> are archived to flash in
<code>/data/log/</code> at least once before rebooting.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="watchdog-fault-tables">Watchdog Fault Tables<a class="hash-link" href="#watchdog-fault-tables" title="Direct link to heading">​</a></h3><ul><li>The tables below list all detected faults.</li><li>The <code>/var/log/</code> files mentioned in the fault tables are also archived to flash
in <code>/data/log/</code> on reboot.</li></ul><table><thead><tr><th>Fault Name</th><th>Description</th><th>Repair Action</th><th>Keyword in repair/reboot history</th><th>Fault-specific logs and comments</th></tr></thead><tbody><tr><td>POP</td><td>No PoP node was reachable for 1 hour</td><td>Reboot</td><td>pop_unreachable</td><td><ul><li>Traceroute logs are saved in <code>/var/log/openr</code> every few minutes when PoP is unreachable.</li> <li>The log also indicates the times when the PoP nodes were unknown.</li> <li>Use the <code>get_pop_ip</code> command to find the PoP nodes currently known to the unit.</li></ul></td></tr><tr><td>UPG</td><td>On first boot of an upgrade image, E2E minion was unable to connect to the controller for several minutes</td><td>Revert to previous TG image and reboot</td><td>testcode-timed-out</td><td>n/a</td></tr><tr><td>LINK</td><td>No RF link formed for some minutes (default 15) on a baseband card that was healthy at least once since the last e2e_minion startup.</td><td>Reload FW on all baseband cards and restart E2E minion</td><td>prog-<!-- -->[macAddress]<!-- -->-nolink</td><td><ul><li>The reported mac address is the first baseband card on which the fault was detected.</li><li>The actual timeout is a determined by the <code>radioParamsBase.fwParams.noLinkTimeout</code> config parameter.</li><li><code>/var/log/fwdumps/RF/</code> (rotated log archives)</li></ul></td></tr><tr><td>FW</td><td>Firmware has crashed, or the datapath from FW to Linux is dead on a baseband card that was healthy at least once since the last e2e_minion startup.</td><td>Reload FW on all baseband cards and restart E2E minion</td><td>prog-<!-- -->[macAddress]<!-- -->-timeout</td><td><ul><li>The reported mac address is the first baseband card on which the fault was detected.</li> <li><code>/var/log/fwdumps/RF/</code> (rotated log archives)</li></ul></td></tr><tr><td>BBINIT</td><td>None of the baseband cards was initialized with a mac address for 1 minute after the last e2e_minion restart, or internal error.</td><td>Reload FW on all baseband cards and restart E2E minion</td><td>prog-init</td><td><code>/var/log/fwdumps/RF/</code> (rotated log archives)</td></tr><tr><td>PEER</td><td>Some RF links are up, but none reached its peer for 1 minute</td><td><ul><li>Reload FW on all baseband cards and restart E2E minion</li></ul></td><td>link_monit.sh</td><td><code>/var/log/fwdumps/RF/</code> (rotated log archives)</td></tr><tr><td>E2E</td><td>Failed to restart E2E minion</td><td>Reboot</td><td>e2e_minion_restart_failed_prog, e2e_minion_restart_failed_link</td><td><ul><li>Restarting e2e minion also reloads the FW, reloads drivers, and initializes the FW.</li> <li>The suffix (<code>_prog</code> and <code>_link</code>) identifies the specific health monitor that failed to restart e2e minion.</li></ul></td></tr><tr><td>GPS</td><td>GPS is in a bad or unlocked state continuously for 30 minutes (the timeout persists across reboots).</td><td><ul><li>Log the fault without repairing it</li></ul></td><td>gps</td><td>n/a</td></tr><tr><td>CFG1</td><td>A unit running with an new/unverified config did not connect to the controller for about 7 minutes.</td><td>Reboot and fall back to the previous, working configuration</td><td>config-fallback-timed-out</td><td>n/a</td></tr><tr><td>CFG2</td><td>A unit with a config change since startup, rebooted before connecting to the controller, and also before the deadline to do so expired.</td><td>Start up with the unverified new config</td><td>config-unverified-new-config</td><td>Some config changes only take effect after a re-start, so we allow one re-start with an unverified new config.</td></tr><tr><td>CFG3</td><td>A unit that booted up with an unverified new config, rebooted before connecting to the controller, and also before the deadline to do so expired.</td><td>Reboot and fall back to the previous, working configuration</td><td>config-fallback</td><td>n/a</td></tr><tr><td>DATA</td><td>/data flash partition is full</td><td>Reboot and clean up /data</td><td>fsys-data-full</td><td><ul><li>The reboot history may be truncated.</li> <li>When <code>/data</code> is completely full, the &quot;fsys-data-full&quot; reboot reason may not show up in the reboot history.</li><li>Only the <code>/data/log</code> directory is cleaned up.</li></ul></td></tr><tr><td>TMP</td><td>/tmp is full</td><td>Reboot and also clean up /data if necessary</td><td>fsys-tmp-full</td><td>n/a</td></tr><tr><td>VPP</td><td>The vpp cli (<code>vppctl</code>) has deadlocked</td><td>Restart vpp</td><td>vpp_cli</td><td>n/a</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="disabling-the-watchdog">Disabling the Watchdog<a class="hash-link" href="#disabling-the-watchdog" title="Direct link to heading">​</a></h3><ul><li>Some watchdogs can be temporarily disabled during troubleshooting to avoid
undesirable repair actions and reboots.</li><li>The maximum watchdog disable period is one day.</li><li>The watchdogs that monitor the filesystem, revert upgrades, and revert config
cannot be disabled.</li></ul><p>The watchdog CLI provides the following commands for disabling watchdogs:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Disable all non-critical watchdogs for 45 minutes (max 1440 minutes, or 1 day)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/etc/init.d/watchdog.sh dis </span><span class="token number" style="color:#36acaa">45</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Re-enable all watchdogs</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/etc/init.d/watchdog.sh en</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><a id="troubleshooting-upgrades"></a><h2 class="anchor anchorWithStickyNavbar_LWe7" id="manual-upgrades">Manual Upgrades<a class="hash-link" href="#manual-upgrades" title="Direct link to heading">​</a></h2><p>Software upgrades on Terragraph nodes should normally be performed using the NMS
UI or TG CLI (see <a href="/docs/runbook/Maintenance">Maintenance and Configuration</a>). If this is
not possible, then manual upgrades can be performed <strong>but should only be used as
a last resort</strong>. The Terragraph upgrade image, <code>tg-update-qoriq.bin</code>,
is a self-extracting binary file.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="manual-upgrade-steps">Manual Upgrade Steps<a class="hash-link" href="#manual-upgrade-steps" title="Direct link to heading">​</a></h3><ol><li>Sanity check the release/version of the TG upgrade binary. This can be done
in a Bash shell before copying the image to the node, or afterwards on the
node (following step 3).</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ ./tg-update-qoriq.bin -m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string" style="color:#e3116c">&quot;version&quot;</span><span class="token builtin class-name">:</span><span class="token string" style="color:#e3116c">&quot;Facebook Terragraph Release RELEASE_M70-0-g1ad294cc0 michaelcallahan@devvm4933 2021-03-05T17:21:02&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string" style="color:#e3116c">&quot;md5&quot;</span><span class="token builtin class-name">:</span><span class="token string" style="color:#e3116c">&quot;d0149fe85367780989ea642fe0bd480b&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string" style="color:#e3116c">&quot;model&quot;</span><span class="token builtin class-name">:</span><span class="token string" style="color:#e3116c">&quot;NXP TG Board&quot;</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string" style="color:#e3116c">&quot;hardwareBoardIds&quot;</span><span class="token plain">:</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;NXP_LS1048A_PUMA&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="2"><li>Temporarily disable watchdogs to ensure that the node will not reboot during
the upgrade.</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Disable watchdogs for 20 minutes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ /etc/init.d/watchdog.sh dis </span><span class="token number" style="color:#36acaa">20</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="3"><li>Copy the upgrade image to the <code>/tmp/</code> directory on the node, replacing the
IP address in the command below with the correct IP. Check that the
executable permission was preserved (SCP should do this automatically).</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">scp</span><span class="token plain"> tg-update-qoriq.bin root@</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">2001</span><span class="token plain">::1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">:/tmp/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="4"><li>Write the new image to the flash, then boot it up.</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ /tmp/tg-update-qoriq.bin -wrt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="5"><li>Log back into the node after it has rebooted, and sanity check the new image
version.</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> /etc/tgversion</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Facebook Terragraph Release RELEASE_M70-0-g1ad294cc0 michaelcallahan@devvm4933 </span><span class="token number" style="color:#36acaa">2021</span><span class="token plain">-03-05T17:21:02</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="6"><li>Finalize the upgrade. Step 4 boots the node into a &quot;test&quot; state in which a
reboot for any reason causes an automatic fallback to the old image;
finalization cancels this &quot;test&quot; state.</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># This command also prints info about the flash partitions,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># and it is safe to use when there is no new image to finalize.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ testcode c</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Note:</strong> If the new image is not finalized within 6 minutes, <em>and</em> the E2E
minion is enabled, <em>and</em> it is unable to connect to the E2E controller, then
the watchdog will trigger a reboot and revert to the previous image. The
&quot;test&quot; state and the reversion are safety features that prevent bricking
the node in all stages of the upgrade process. The &quot;test&quot; upgrade state can be
skipped if absolutely necessary by issuing a different command in Step 4:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ /tmp/tg-update-qoriq.bin -ur</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><a id="troubleshooting-reverts"></a><h2 class="anchor anchorWithStickyNavbar_LWe7" id="manual-reverts">Manual Reverts<a class="hash-link" href="#manual-reverts" title="Direct link to heading">​</a></h2><p>It is sometimes convenient to manually revert to the inactive/secondary boot
image. This can only be done when the unit is not in the middle of an upgrade,
and not in the &quot;test&quot; state described in the &quot;Manual Upgrades&quot; section above.</p><ol><li>Sanity check the TG version of the secondary boot image. Make sure that it
is what you expect.</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ testcode </span><span class="token function" style="color:#d73a49">v</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">TG version </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> secondary boot partition </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">/dev/mmcblk0p2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Facebook Terragraph Release RELEASE_M70-0-g1ad294cc0 michaelcallahan@devvm4933 </span><span class="token number" style="color:#36acaa">2021</span><span class="token plain">-03-05T17:21:02</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="2"><li>Swap the roles of the primary and secondary boot partitions.</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ testcode x</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Swapping the roles of the primary </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">/dev/mmcblk0p1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> and</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">the secondary </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">/dev/mmcblk0p2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> boot partitions.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Done</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Reboot now to activate the new primary image</span><span class="token operator" style="color:#393A34">!</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="3"><li>Reboot to activate the newly designated primary image.</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">reboot</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Note:</strong> You can undo the revert request between Steps 2 and 3 as follows:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ testcode c</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/terragraph/meta-terragraph/edit/main/docs/../docs/runbook/Troubleshooting.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_eYIM" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vbeJ"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/runbook/Testing"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Testing and Measurements</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/runbook/Appendix"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Appendix</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#basic-network-debugging" class="table-of-contents__link toc-highlight">Basic Network Debugging</a><ul><li><a href="#checking-controller-status" class="table-of-contents__link toc-highlight">Checking controller status</a></li><li><a href="#checking-network-status" class="table-of-contents__link toc-highlight">Checking network status</a></li><li><a href="#all-nodes-are-offline" class="table-of-contents__link toc-highlight">All nodes are offline</a></li><li><a href="#pop-nodes-are-online-and-remaining-nodeslinks-are-offline" class="table-of-contents__link toc-highlight">PoP nodes are online, and remaining nodes/links are offline</a></li><li><a href="#a-specific-node-is-offline" class="table-of-contents__link toc-highlight">A specific node is offline</a></li><li><a href="#a-specific-link-is-offline" class="table-of-contents__link toc-highlight">A specific link is offline</a></li><li><a href="#terragraph-unit-is-unresponsive-or-not-powered" class="table-of-contents__link toc-highlight">Terragraph unit is unresponsive or not powered</a></li><li><a href="#fiber-is-connected-to-terragraph-but-remote-switchrouter-indicates-no-link-integrity" class="table-of-contents__link toc-highlight">Fiber is connected to Terragraph, but remote switch/router indicates no link integrity</a></li><li><a href="#ethernet-is-connected-to-terragraph-but-ethernet-device-indicates-no-link-integrity" class="table-of-contents__link toc-highlight">Ethernet is connected to Terragraph, but Ethernet device indicates no link integrity</a></li></ul></li><li><a href="#basic-node-debugging" class="table-of-contents__link toc-highlight">Basic Node Debugging</a><ul><li><a href="#first-steps" class="table-of-contents__link toc-highlight">First Steps</a></li><li><a href="#manual-link-bring-up" class="table-of-contents__link toc-highlight">Manual Link Bring-Up</a></li></ul></li><li><a href="#routing" class="table-of-contents__link toc-highlight">Routing</a><ul><li><a href="#triage" class="table-of-contents__link toc-highlight">Triage</a></li><li><a href="#background" class="table-of-contents__link toc-highlight">Background</a></li><li><a href="#basic-checks" class="table-of-contents__link toc-highlight">Basic Checks</a></li><li><a href="#link-discovery" class="table-of-contents__link toc-highlight">Link Discovery</a></li><li><a href="#neighbor-discovery" class="table-of-contents__link toc-highlight">Neighbor Discovery</a></li><li><a href="#key-value-store-kvstore" class="table-of-contents__link toc-highlight">Key-Value Store (<code>KvStore</code>)</a></li><li><a href="#link-state-database-lsdb" class="table-of-contents__link toc-highlight">Link-State Database (<code>Lsdb</code>)</a></li><li><a href="#route-computation" class="table-of-contents__link toc-highlight">Route Computation</a></li><li><a href="#route-programming" class="table-of-contents__link toc-highlight">Route Programming</a></li></ul></li><li><a href="#logs" class="table-of-contents__link toc-highlight">Logs</a><ul><li><a href="#log-descriptions" class="table-of-contents__link toc-highlight">Log Descriptions</a></li><li><a href="#automatically-generated-logs" class="table-of-contents__link toc-highlight">Automatically-Generated Logs</a></li><li><a href="#logs-generated-manually" class="table-of-contents__link toc-highlight">Logs Generated Manually</a></li></ul></li><li><a href="#firmware" class="table-of-contents__link toc-highlight">Firmware</a><ul><li><a href="#what-are-the-signs-of-firmware-crashes" class="table-of-contents__link toc-highlight">What are the signs of firmware crashes?</a></li><li><a href="#what-are-the-possible-causes-of-firmware-crashes" class="table-of-contents__link toc-highlight">What are the possible causes of firmware crashes?</a></li><li><a href="#what-are-signs-that-a-node-has-rebooted-unexpectedly" class="table-of-contents__link toc-highlight">What are signs that a node has rebooted unexpectedly?</a></li><li><a href="#why-cant-a-wireless-link-be-established" class="table-of-contents__link toc-highlight">Why can&#39;t a wireless link be established?</a></li><li><a href="#why-is-throughput-lower-than-expected" class="table-of-contents__link toc-highlight">Why is throughput lower than expected?</a></li><li><a href="#change-log-levels-of-firmware-modules" class="table-of-contents__link toc-highlight">Change log levels of firmware modules</a></li></ul></li><li><a href="#watchdog" class="table-of-contents__link toc-highlight">Watchdog</a><ul><li><a href="#watchdog-logs" class="table-of-contents__link toc-highlight">Watchdog Logs</a></li><li><a href="#watchdog-fault-tables" class="table-of-contents__link toc-highlight">Watchdog Fault Tables</a></li><li><a href="#disabling-the-watchdog" class="table-of-contents__link toc-highlight">Disabling the Watchdog</a></li></ul></li><li><a href="#manual-upgrades" class="table-of-contents__link toc-highlight">Manual Upgrades</a><ul><li><a href="#manual-upgrade-steps" class="table-of-contents__link toc-highlight">Manual Upgrade Steps</a></li></ul></li><li><a href="#manual-reverts" class="table-of-contents__link toc-highlight">Manual Reverts</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Terragraph</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/runbook/Overview">Overview</a></li><li class="footer__item"><a href="https://www.facebook.com/connectivity/solutions/terragraph" target="_blank" rel="noopener noreferrer" class="footer__link-item">Meta Connectivity<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/terragraph/meta-terragraph" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discord.gg/HQaxCevzus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/terragraph/tgnms" target="_blank" rel="noopener noreferrer" class="footer__link-item">Terragraph NMS<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/terragraph/terragraph-planner" target="_blank" rel="noopener noreferrer" class="footer__link-item">Terragraph Planner<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Legal</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://opensource.facebook.com/legal/privacy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Privacy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://opensource.facebook.com/legal/terms/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Terms<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 Meta Platforms, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.0199c3c1.js"></script>
<script src="/assets/js/main.c2ab4c5b.js"></script>
</body>
</html>