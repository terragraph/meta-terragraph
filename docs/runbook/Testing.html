<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-runbook/Testing">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.21">
<link rel="search" type="application/opensearchdescription+xml" title="Terragraph" href="/opensearch.xml">
<link rel="stylesheet" href="/katex/katex.min.css"><title data-rh="true">Testing and Measurements | Terragraph</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://terragraph.com/logo/terragraph-logo-full-RGB.png"><meta data-rh="true" name="twitter:image" content="https://terragraph.com/logo/terragraph-logo-full-RGB.png"><meta data-rh="true" property="og:url" content="https://terragraph.com/docs/runbook/Testing"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Testing and Measurements | Terragraph"><meta data-rh="true" name="description" content="This document describes the testing and measurement capabilities of Terragraph."><meta data-rh="true" property="og:description" content="This document describes the testing and measurement capabilities of Terragraph."><link data-rh="true" rel="icon" href="/logo/terragraph-logo-favicon-32x32-full-RGB.png"><link data-rh="true" rel="canonical" href="https://terragraph.com/docs/runbook/Testing"><link data-rh="true" rel="alternate" href="https://terragraph.com/docs/runbook/Testing" hreflang="en"><link data-rh="true" rel="alternate" href="https://terragraph.com/docs/runbook/Testing" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://TB9T0CGM6Y-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.48218837.css">
<link rel="preload" href="/assets/js/runtime~main.0199c3c1.js" as="script">
<link rel="preload" href="/assets/js/main.c2ab4c5b.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/logo/terragraph-logo-favicon-32x32-full-RGB.svg" alt="Terragraph Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/logo/terragraph-logo-favicon-32x32-white-RGB.svg" alt="Terragraph Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/terragraph/meta-terragraph" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link githubButton navbarIconButton" title="GitHub"></a><a href="https://discord.gg/HQaxCevzus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link discordButton navbarIconButton" title="Discord"></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Docs</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/runbook">Runbook</a></li><li><a class="dropdown__link" href="/docs/developer">Developer Manual</a></li><li><a class="dropdown__link" href="/docs/whitepapers">Whitepapers</a></li></ul></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/runbook">Runbook</a><button aria-label="Toggle the collapsible sidebar category &#x27;Runbook&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/runbook/Overview">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/runbook/Quick_Start">Quick Start</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/runbook/Planning">Network Planning</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/runbook/Deployment">Deployment and Installation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/runbook/Maintenance">Maintenance and Configuration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/runbook/Monitoring">Monitoring and Alerting</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/runbook/Routing">Routing and Traffic Engineering</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/runbook/Testing">Testing and Measurements</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/runbook/Troubleshooting">Troubleshooting</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/runbook/Appendix">Appendix</a></li></ul></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_GujU"><div class="docItemContainer_Adtb"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/runbook"><span itemprop="name">Runbook</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Testing and Measurements</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_aoJ5"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Testing and Measurements</h1><p>This document describes the testing and measurement capabilities of Terragraph.</p><a id="testing-scans"></a><h2 class="anchor anchorWithStickyNavbar_LWe7" id="scans">Scans<a class="hash-link" href="#scans" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="background">Background<a class="hash-link" href="#background" title="Direct link to heading">​</a></h3><p>Association between two Terragraph nodes begins with initial beamforming.
Initial beamforming does a sweep of transmit (Tx) and receive (Rx) beams on a
coarse, 2x grid, aiming to find the best combination of beams in terms of SNR.
Those beams are used when the link is associated.</p><p>A scan is an opportunity to measure SNR and interference and optionally to
refine beams once the link is associated in a dedicated time slot. Scans are
done for multiple reasons:</p><ul><li><strong>Association</strong> - The initial beamforming scan is required to associate.</li><li><strong>Refinement</strong> - Other types of scans can refine the 2x grid used in initial
beamforming. Additionally, scans are used to adjust beams because
conditions change over time.</li><li><strong>Measurement and Analysis</strong> - For example, scans can measure
self-interference across the network.</li><li><strong>Debugging</strong> - If a particular link is underperforming (e.g., the data rate
is too low, SNR is too low, or power is too high), one tool for debugging
is to run a manual scan (PBF). Afterwards, scan results are collected and
can be viewed in the NMS UI.</li></ul><p>During a scan opportunity, there is typically one transmitter (initiator) and
one or more receivers (responders). The initiator and all responders sweep over
a set of beams and report results back to the E2E controller. The initiator
report contains only metadata about the scan; the responder report includes the
measured SNR and RSSI for each Tx/Rx beam combination. SNR can only be measured
if the receiver is able to detect the packet; the receiver sensitivity is around
-10dB SNR.</p><p>Scans are generally either wide or selective. A wide scan evaluates the entire
range of beams, while a selective scan evaluates a narrower range of beams
specific to the scan type. Selective scans cause less interference over the
short duration of the scan.</p><p>The transmit power of the initiator can be specified, but more commonly, the
transmitter in the scan chooses the transmit power based on the transmit power
it is currently using to send data. All nodes run Transmit Power Control (TPC),
so the power changes over time. When selecting the power for a scan, the node
uses a biased average of the currently used transmit power. It is biased toward
higher transmit power in order to measure worst-case interference. If a node has
multiple attached clients (P2MP), then the transmit power is the maximum over
all links.</p><p>Scans are initiated by an E2E controller command or API call. By default, no
scans are run.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="scan-types">Scan Types<a class="hash-link" href="#scan-types" title="Direct link to heading">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="initial-beamforming-ibf">Initial Beamforming (IBF)<a class="hash-link" href="#initial-beamforming-ibf" title="Direct link to heading">​</a></h4><p>IBF scans are run by the firmware during ignition, without involving the E2E
controller. The scan finds a good beam angle, but not the &quot;best beam&quot; because it
needs to complete quickly. IBF runs using the maximum allowed transmit power.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="periodic-beamforming-pbf">Periodic Beamforming (PBF)<a class="hash-link" href="#periodic-beamforming-pbf" title="Direct link to heading">​</a></h4><p>PBF scans find the best beam angle for the best SNR. These need to be run
periodically since temperature, weather, and other changes affect the SNR of the
selected beam.  A &quot;fine&quot; PBF scan operates over the entire range of beam angles
(roughly +/- 45 degrees), whereas a &quot;selective&quot; PBF scan operates only over the
current beam +/- 1.4 degrees.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="interference-measurement-im">Interference Measurement (IM)<a class="hash-link" href="#interference-measurement-im" title="Direct link to heading">​</a></h4><p>IM scans measure interference between nearby nodes (not necessarily connected by
a link). These use the same transmit power calculation as PBF.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="runtime-calibration-rtcal">Runtime Calibration (RTCAL)<a class="hash-link" href="#runtime-calibration-rtcal" title="Direct link to heading">​</a></h4><p>In contrast to PBF, which attempts to find the best beam angle based on a fine
grid, RTCAL makes very fine adjustments to the antenna weights without changing
the beam angle. Consider the following analogy — if Terragraph were a movie
projector, then PBF would angle the projector until it faces the screen
directly, and RTCAL would make fine adjustments to the focus (but the angling is
done electronically, without motors).</p><p>RTCAL scans are <strong>not</strong> supported in QTI firmware. Instead, a combination of PBF
scans and MTPO (multi-tile phase offset) calibration is used to achieve the
similar goal of adjusting the inter-tile phase offsets to maximize beamforming
gain of the antenna array.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="coordinated-beamforming-cbf">Coordinated Beamforming (CBF)<a class="hash-link" href="#coordinated-beamforming-cbf" title="Direct link to heading">​</a></h4><p>CBF scans (i.e., Interference Nulling scans) are used to reduce interference.
These scans are <strong>not</strong> currently supported in QTI firmware.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="scan-scheduling">Scan Scheduling<a class="hash-link" href="#scan-scheduling" title="Direct link to heading">​</a></h3><p>The amount of time it takes to run a scan for the entire network depends on the
network topology. For a network with approximately 20 or more nodes, scans will
typically take on the order of 10-20 minutes, but this depends on the specific
locations of the nodes because of the Scheduling Groups described below.
Generally, the time it takes to complete a full-network scan does not depend on
the size of the network once the network reaches over 20 nodes because scans run
in parallel.</p><p>This section will explain how scans are scheduled and why it takes tens of
minutes to complete a round of scans for the network.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="slotmap">Slotmap<a class="hash-link" href="#slotmap" title="Direct link to heading">​</a></h4><p>At a high level, a ~52-second slotmap is defined. Within a slotmap, there are
typically one or two opportunities to run a given scan type (e.g., PBF or IM).
Scans can run in parallel on different Terragraph nodes, but only if the two
scans do not cause RF interference with each other. A full network scan can take
tens of minutes because several slotmaps are needed to cover all nodes in the
network.</p><p>Scans can be initiated manually for a single link (for debugging), but they are
more commonly scheduled periodically for the entire network (e.g., every 6
hours). Scans need to be scheduled according to certain constraints, and a node
cannot perform more than one scan at a time. Because scans involve a sweep of
beams, simultaneous scans should not be run on nodes that are close to each
other in order to avoid erroneous measurements. For example, during a PBF scan
between nodes A→B, a simultaneous PBF scan between nodes C→D would only be
scheduled if nodes A and B are physically far away from  nodes C and D.</p><p>A <em>slotmap</em> is defined to coordinate scan scheduling as shown below:</p><p align="center"><img loading="lazy" src="/figures/bftd.jpg" width="1200" class="img_ev3q"><br><em>Slotmap Definition</em></p><ul><li><code>Nf</code> = 4 frames (1 superframe = 1.6ms)</li><li><code>Ns</code> = 16 superframes (one BWGD = 25.6ms)</li><li><code>Nb</code> = 16 BWGDs (one BFTD = 409.6ms)</li><li><code>Nm</code> = 128 BFTDs (one slotmap ~= 52.5 seconds)</li></ul><p>An example slotmap is shown below for the different scan types.</p><p align="center"><img loading="lazy" src="/figures/slotmap_example.svg" width="1000" class="img_ev3q"><br><em>Slotmap Scheduling Example</em></p><p>For example, two PBF scans can run in each slotmap. The slotmap is configurable.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="scheduling-groups">Scheduling groups<a class="hash-link" href="#scheduling-groups" title="Direct link to heading">​</a></h4><p>Multiple scans of the same type (e.g., PBF) can run at the same time on
different links/nodes in the network in groups. But nodes within a group have to
be separated by a minimum distance to avoid interference. The distance is
configurable (e.g., 350 meters). The E2E controller calculates scheduling groups
based on GPS coordinates and the configured distance.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="manual-and-automated-scans">Manual and Automated Scans<a class="hash-link" href="#manual-and-automated-scans" title="Direct link to heading">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="manual">Manual<a class="hash-link" href="#manual" title="Direct link to heading">​</a></h4><p>A manual scan is a one-shot scan (either for a particular set of nodes or once
for the entire network), used primarily for debugging a link. Scans can be
manually initiated using the TG CLI:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># PBF scan on link node1-&gt;node2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ tg scan start -t pbf --tx node1 --rx node2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># IM scan from node1-&gt;node{2,3,4}, even if there are no links between them</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ tg scan start -t im --tx node1 --rx node2 --rx node3 --rx node4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Run IM scan on whole network (more on this later)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ tg scan start -t im</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="automated">Automated<a class="hash-link" href="#automated" title="Direct link to heading">​</a></h4><p>Scans can be automatically initiated by the E2E controller on a schedule set
using the TG CLI:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Start whole-network PBF scans every 30 minutes, starting 30 minutes from now</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ tg scan schedule --pbf </span><span class="token number" style="color:#36acaa">1800</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Start whole-network IM scans every 20 minutes, starting 20 minutes from now</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ tg scan schedule --im </span><span class="token number" style="color:#36acaa">1200</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Scanning impacts network performance for the short duration of a scan (between
51ms and 1.6s depending on the scan type), and should be run infrequently
(typically every 6 to 12 hours). During a scan, ~60us time slots (shown in green
in the slotmap definition figure above) are reserved for scans and therefore not
used to transmit data; in the 200us subframe, this is approximately a 30%
overhead. Depending on the scan type and network topology, a scan can also cause
interference on neighboring links that are not involved in the scan. This is
because a scan sweeps over multiple beams and therefore can directly transmit
energy in a direction other than the associated link(s). Interference will not
have any long-term impact but can, momentarily, cause a reduction in data rate
on neighboring links.</p><p>By default, the controller initiates PBF, RTCAL, and CBF scans every 4 hours
(defined in <code>/etc/e2e_config/controller_config_default.json</code>).</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="scan-results">Scan Results<a class="hash-link" href="#scan-results" title="Direct link to heading">​</a></h4><p>Completed scan results are processed by Query Service, and can be viewed in the
NMS.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/terragraph/meta-terragraph/edit/main/docs/../docs/runbook/Testing.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_eYIM" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vbeJ"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/runbook/Routing"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Routing and Traffic Engineering</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/runbook/Troubleshooting"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Troubleshooting</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#scans" class="table-of-contents__link toc-highlight">Scans</a><ul><li><a href="#background" class="table-of-contents__link toc-highlight">Background</a></li><li><a href="#scan-types" class="table-of-contents__link toc-highlight">Scan Types</a></li><li><a href="#scan-scheduling" class="table-of-contents__link toc-highlight">Scan Scheduling</a></li><li><a href="#manual-and-automated-scans" class="table-of-contents__link toc-highlight">Manual and Automated Scans</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Terragraph</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/runbook/Overview">Overview</a></li><li class="footer__item"><a href="https://www.facebook.com/connectivity/solutions/terragraph" target="_blank" rel="noopener noreferrer" class="footer__link-item">Meta Connectivity<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/terragraph/meta-terragraph" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discord.gg/HQaxCevzus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/terragraph/tgnms" target="_blank" rel="noopener noreferrer" class="footer__link-item">Terragraph NMS<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/terragraph/terragraph-planner" target="_blank" rel="noopener noreferrer" class="footer__link-item">Terragraph Planner<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Legal</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://opensource.facebook.com/legal/privacy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Privacy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://opensource.facebook.com/legal/terms/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Terms<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 Meta Platforms, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.0199c3c1.js"></script>
<script src="/assets/js/main.c2ab4c5b.js"></script>
</body>
</html>